define("OK/AjaxNavigationLog",["OK/logger"],function(j){var d="ajaxrequestdatatime.send.time";var c;var g;var i;var f;var e=false;function l(n,o,m){g=o;i=m;c=JSON.parse(n);e=true;}function k(p){var n=100,m=2000,o;if(p<n){return 1;}if(p>m){p=m;}o=~~(p/n);return n*o;}function b(n,m){if(e){var p=a(m);if(p.length>0){j.duration(d,n,i+"_"+p,g);var o=k(n);if(o){j.success("ad","ajax_"+i+"_"+p,o);}}}}function a(n){var m=h("st.cmd",n),r=h("cmd",n);for(var q=0;q<c.length;q++){var t=c[q];if(t.indexOf("_")>-1){var p=t.split("_");var o=p[0];var s=p[1];if("*"===o&&r===s){return s;}if(m===o&&r===s){return m+"_"+r;}}else{if(m===t){return t;}}}return"";}function h(r,m){var q=m.substring(Math.max(0,m.indexOf("?")+1)).split("&");for(var n=0;n<q.length;n++){var p=q[n];var o=p.indexOf(r+"=");if(o===0){return p.substr(r.length+1);}}return"";}return{log:b,activate:function(m){if(f){return;}l(m.textContent,m.getAttribute("data-region"),m.getAttribute("data-countrycode"));f=true;},deactivate:function(){c.length=0;g="";i="";f=false;}};});define("OK/utils/utils",["jquery","OK/logger","OK/AjaxNavigationLog"],function(e,l,b){var j=document.getElementById("hook_Cfg_GwtExperimentsCfg");var c=j?OK.util.parseJSON(j.innerHTML):{};var d="data-";function f(p,n,o){var m=p.split(OK.navigation.SPLITER);m.forEach(function(q,r){if(o[r]){OK.hookModel.setHookContent(o[r],q);}});}function i(p,n,o,m){var r=Date.now();var q=e.ajax(p);m.xhr=q;m.fail(function(){q.abort();});q.done(function(u,w,v){b.log(Date.now()-r,p.url);if(u&&v.responseText&&u.length===0&&v.responseText.length!==0&&v.responseText!="[]"){l.error("ajax",w);l.clob("ajax",JSON.stringify({requestData:p,response:v.responseText}));}var t=v.getResponseHeader("TKN");if(t){OK.tkn.set(t);}var s=v.getResponseHeader("Redirect-Location");if(s){n(s);m.reject(v,w,"Redirect");return;}m.resolve(u,w,v);});q.fail(function(s,u,t){if(o>0){if(u=="timeout"||!p.timeout){i(p,n,--o,m);}else{setTimeout(function(){i(p,n,--o,m);},p.timeout);}}else{m.reject(s,u,t);}});return m;}function a(o,m,p){var n=p.getResponseHeader(OK.navigation.HEADER);if(n){return n.split(",");}return null;}function k(p,n){if(typeof p==="string"){p=document.getElementById(p);}var q={};for(var o=0;o<p.attributes.length;o++){var m=p.attributes[o];if(m.name.indexOf(d)==0){q[m.name.substring(d.length)]=m.value;}}if(n){p.parentNode.removeChild(p);}return q;}function g(n,m){var p={};var o=Array.prototype.slice.call(n.elements);if(m){o=o.filter(m);}o.forEach(function(r){var q=r.name;if(q){if(r.type==="checkbox"){p[q]=r.checked?"on":"off";}else{p[q]=r.value;}}});return p;}function h(n){var m=n?n.replace(/<!--/ig,"").replace(/-->/ig,""):null;return m?JSON.parse(m):null;}return{ajax:function(n,m,p){if(arguments.length>1){if(typeof arguments[1]!=="function"){p=m;m=undefined;}}p=p||0;m=m||function(r){if(OK.navigation.redirect){OK.navigation.redirect(r);}else{document.location.href=decodeURIComponent(r);}};var q=n.data||{};var o=n.beforeSend;n.type=n.type||"POST";if(n.type==="POST"&&n.contentType&&n.contentType.indexOf("application/json")!=-1){if(typeof q!=="string"){q=JSON.stringify(q);}}else{q["gwt.requested"]=window.pageCtx.gwtHash;}n.data=q;n.beforeSend=function(s,r){s.setRequestHeader("TKN",OK.tkn.get());if(o){o.apply(this,arguments);}};return i(n,m,p,e.Deferred());},getBlockIds:a,updateBlockModelCallback:function(o,m,p){var n=a(o,m,p);if(n){f(o,m,n);}},updateBlocks:f,gwtExperimentsCfg:c,removeTags:function(m){return typeof m==="string"?m.replace(/<[^>]*>/g,""):m;},isElementInViewport:function(m){var n=m.getBoundingClientRect();if(n.top<0||n.left<0||n.bottom>window.innerHeight||n.right>window.innerWidth){return false;}return(m.contains(document.elementFromPoint(n.left,n.top))||m.contains(document.elementFromPoint(n.right,n.top))||m.contains(document.elementFromPoint(n.right,n.bottom))||m.contains(document.elementFromPoint(n.left,n.bottom)));},isElementPartiallyInViewport:function(q,n){if(!n){return this.isElementInViewport(q);}var r=q.getBoundingClientRect(),m=Math.min(r.bottom,window.innerHeight)-Math.max(0,r.top),o=Math.min(r.right,window.innerWidth)-Math.max(0,r.left),p=q.offsetHeight,s=q.offsetWidth;return p*n<=m&&s*n<=o;},extendDeep:function(m){m=m||{};for(var o=1;o<arguments.length;o++){var p=arguments[o];if(!p){continue;}for(var n in p){if(p.hasOwnProperty(n)){if(typeof p[n]==="object"&&!Array.isArray(p[n])){m[n]=this.extendDeep(m[n],p[n]);}else{m[n]=p[n];}}}}return m;},urlBase64ToUint8Array:function(s){var q=p("=",(4-s.length%4)%4);var m=(s+q).replace(/\-/g,"+").replace(/_/g,"/");var r=window.atob(m);var o=new Uint8Array(r.length);for(var n=0;n<r.length;++n){o[n]=r.charCodeAt(n);}return o;function p(u,v){var t="";while(v-->0){t+=u;}return t;}},deferred:function(){var n,m;return{promise:new Promise(function(p,o){n=p;m=o;}),resolve:n,reject:m};},getAttributesFromElement:k,getFormData:g,parseJson:h};});define("OK/utils/dom",[],function(){function f(i,k){if(i){if(i.nodeType==11){var h=[];for(var l=0;l<i.childNodes.length;l++){var j=i.childNodes[l];if(j.getElementsByClassName){h=h.concat(Array.prototype.slice.call(j.getElementsByClassName(k)));}}return h;}return Array.prototype.slice.call(i.getElementsByClassName(k));}return[];}function g(h,i){var j=f(h,i);return j.length?j[0]:null;}function d(h,i,k,j){if(!j){h=h.parentElement;}while(h){if(!i||!h.classList||h.classList.contains(i)){return h;}if(k&&(k===h)){return null;}h=h.parentElement;}return h;}function b(i,j,l,k){if(!k){i=i.parentElement;}while(i){var h=j(i);if(h){return i;}if(l&&(l===i)){return null;}i=i.parentElement;}return i;}function e(i,h,l){var k=function(m){return m.getAttribute(h);},j=b(i,k,l,true);return j?k(j):null;}function a(i){if(!Array.isArray(i)){i=[i];}var h;i.forEach(function(j){h=j.parentNode;if(h){h.removeChild(j);}});}function c(h){var i=h.cloneNode(true);h.parentNode.replaceChild(i,h);return i;}return{byClass:f,firstByClass:g,parent:d,traverseParents:b,getParentsAttrValue:e,forEach:function(i,h){Array.prototype.slice.call(i).forEach(h);return i;},innerHeight:function(h){try{return window.getComputedStyle(h,null).getPropertyValue("height");}catch(i){return h.currentStyle.height;}},outerSize:function(k,l,i){var h=l?k.offsetWidth:k.offsetHeight;if(h!==null){if(i){var j=window.getComputedStyle?window.getComputedStyle(k,null):k.currentStyle;h+=l?parseInt(j.marginLeft,10)+parseInt(j.marginRight,10):parseInt(j.marginTop,10)+parseInt(j.marginBottom,10);}return h;}return 0;},remove:a,one:function(j,i,k){j.addEventListener(i,function h(l){l.target.removeEventListener(l.type,h);return k.call(this,l);});},removeAllListeners:c};});define("OK/registration/StatesManager",[],function(){var b={relogin:{login:function(c){var e=c.getElementsByClassName("js-login-form")[0];if(e){e.elements["st.redirect"].value=null;}var d=c.getElementsByClassName("js-login-relogin")[0];if(d){d.classList.add("__active");}}}};function a(c){this.root=c;this.states=[];this.activeStateId=null;var g=this.root.getElementsByClassName("js-login-state");var f=null;for(var e=0;e<g.length;e++){var d=g[e];var h=d.getAttribute("data-state-id");this.states.push({stateId:h,stateBlock:d,stateLink:c.getElementsByClassName("js-login-"+h)[0]});if(!d.classList.contains("invisible")){f=h;}}this.switchToState(f);}a.prototype.executeStateToStateAction=function(d){var e=b[this.activeStateId];if(e){var c=e[d];if(typeof c==="function"){c(this.root);}}};a.prototype.switchToState=function(e){if(e!==this.activeStateId){for(var d=0;d<this.states.length;d++){var c=this.states[d];c.stateBlock.classList.toggle("invisible",e!==c.stateId);if(c.stateLink){c.stateLink.classList.toggle("__active",e===c.stateId);}}this.executeStateToStateAction(e);this.activeStateId=e;}};return a;});define("OK/registration/Registration",["OK/utils/utils","OK/utils/dom","OK/registration/StatesManager"],function(c,e,b){var a="js-login-nav";function d(){}d.prototype.formHandler=function(j){j.preventDefault();var h={};for(var f=0;f<this.form.elements.length;f++){var g=this.form.elements[f];h[g.name]=g.value;}c.ajax({url:this.form.action,data:h}).done(c.updateBlockModelCallback);};d.prototype.navigationHandler=function(h){h.preventDefault();var f=e.parent(h.target,a,false,true);var g=f.getAttribute("href");if(g){this.statesManager.switchToState(f.id.split("-")[0]);if(OK.historyManager.getState()!==g){OK.historyManager.pushState(g);}this.fixHeight();}};d.prototype.fixHeight=function(){if(this.heightHolder){this.heightHolder.style.minHeight=this.heightHolder.clientHeight+"px";}};d.prototype.activate=function(f){this.loginNavigation=e.byClass(f,a);this.form=e.firstByClass(f,"js-login-form");this.statesManager=new b(f);this.boundNavigationHandler=this.navigationHandler.bind(this);this.boundFormHandler=null;var h=f.getAttribute("data-modal")==="true";e.firstByClass(f,"js-st.field_fJS").value="on";e.firstByClass(f,"js-field_st.screenSize").value=screen.width+" x "+screen.height;e.firstByClass(f,"js-field_st.browserSize").value=window.innerHeight;e.firstByClass(f,"js-field_st.flashVer").value=(okFlashVersion||[]).join(".");if(h){this.boundFormHandler=this.formHandler.bind(this);this.form.addEventListener("submit",this.boundFormHandler);OK.loader.use(["OKCustomJs"],function(){OK.Layers.register("registration",function(){OK.hookModel.setHookContent("PopLayer","");},null,false,null,null);});}else{this.heightHolder=e.parent(f,"anonym_login_w");this.fixHeight();}for(var g=0;g<this.loginNavigation.length;g++){this.loginNavigation[g].addEventListener("click",this.boundNavigationHandler);}};d.prototype.deactivate=function(){if(this.boundFormHandler){this.form.removeEventListener("submit",this.boundFormHandler);}for(var f=0;f<this.loginNavigation.length;f++){this.loginNavigation[f].removeEventListener("click",this.boundNavigationHandler);}};return d;});define("OK/registration/Utils",["OK/utils/utils"],function(b){var a=document.getElementById("generalErrorHook"),c=null,d={registration:{prefix:"st.r.",state:"anonymMain",cmd:"AnonymRegistration"},password:{prefix:"st.",state:"anonymPasswordRecoveryNew",cmd:"AnonymPasswordRecoveryNew"},account:{prefix:"st.",state:"anonymAccountRecoveryFlow",cmd:"AnonymAccountRecoveryFlow"}};if(a){c=a.getAttribute("data-general");a.parentNode.removeChild(a);}return{lastSmsTimeCookieName:"_lastSmsForCodeTime_",addSubmitHook:function(e,f){e.addEventListener("keyup",function(g){if(g.keyCode==13){f();}});},getAttributesFromHook:b.getAttributesFromElement,proceed:function(k,e,g,h){var j={};for(var f in k){j[d[h].prefix+f]=k[f];}var i={data:j,url:"/dk"};i.data["st.cmd"]=d[h].state;i.data.cmd=d[h].cmd;b.ajax(i).done(b.updateBlockModelCallback).fail(function(l,n,m){if(m!="Redirect"&&g&&c){g.classList.remove("invisible");g.textContent=c;}});},toggleClass:function(f,e,g){if(g){f.classList.add(e);}else{f.classList.remove(e);}},hideFieldError:function(e,f){if(e){e.classList.remove("form_i__error");}if(f){f.classList.remove("invisible");}},showFieldError:function(g,h,f,e){if(f){f.textContent=e;}if(g){g.classList.add("form_i__error");}if(h){h.classList.add("invisible");}},getInputValue:function(e){return e?e.value:"";},getValueForLog:function(e){if(e>=100){e=100;}else{if(e>=50){e=50;}else{if(e>=25){e=25;}else{if(e>=10){e=10;}}}}return e;},getActionByType:function(e){if("account"==e){return"accountAction";}else{return"registrationAction";}}};});define("OK/utils/vanilla",["OK/AjaxNavigationLog"],function(d){function l(o){var m=[];for(var n in o){if(o.hasOwnProperty(n)){m.push(encodeURIComponent(n)+"="+encodeURIComponent(o[n]));}}return m.join("&");}function k(m){var q=[],o=m&&m.indexOf("?");if(o>-1){var p=m.substr(o+1),n=p.split("&");n.forEach(function(s){if(s.indexOf("=")>-1){var r=s.split("="),t=r[0],u=r[1];u=decodeURIComponent(u.replace(/\+/g,"%20"));q[t]=u;}});}return q;}function j(r,m){var v=r.type||"POST",t=r.data||{},o=r.url||"",n=/^(https?:)?\/\//.test(o),u={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},q=r.headers||{},p={},w=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,y=r.beforeOpen,x=new XMLHttpRequest();if(!m){m=function(A){if(OK.navigation.redirect){OK.navigation.redirect(A);}else{document.location.href=decodeURIComponent(A);}};}if((v==="POST")&&(typeof t!=="string")){if(r.isFileUpload){q["Content-Type"]="application/octet-stream";var s=(t.name||"1.jpg").replace(/[^\u0000-\u007F]+/gi,"_").substring(0,255);q["Content-Disposition"]='attachment; filename="'+s+'"';}else{q["Content-Type"]="application/x-www-form-urlencoded";if(window.pageCtx.gwtHash){t["gwt.requested"]=window.pageCtx.gwtHash;}t=l(t);}}if(r.contentType&&u.hasOwnProperty(r.contentType)&&!q.hasOwnProperty("Content-Type")){q["Content-Type"]=u[r.contentType];}if(r.dataType&&u.hasOwnProperty(r.dataType)&&!q.hasOwnProperty("Accept")){q.Accept=r.dataType==="*"?u[r.dataType]:u[r.dataType]+", */*; q=0.01";}if(!n&&!q.hasOwnProperty("TKN")){q.TKN=OK.tkn.get();}var z=new Promise(function(C,B){var A=Date.now();if(y){y({xhr:x});}x.open(v,o,true);for(var D in q){if(q.hasOwnProperty(D)){x.setRequestHeader(D,q[D]);}}x.onreadystatechange=function(){if(x.readyState===XMLHttpRequest.HEADERS_RECEIVED){var H=x.getAllResponseHeaders(),F;while(F=w.exec(H)){p[F[1].toLowerCase()]=F[2];}if(!n&&p["redirect-location"]){m(p["redirect-location"]);B(x,x.statusText,"Redirect");return;}}if(x.readyState!==XMLHttpRequest.DONE){return;}if(x.status>=200&&x.status<300||x.status===304){d.log(Date.now()-A,o);var E=x.responseText,I=E;if(r.dataType==="json"){try{I=JSON.parse(E);}catch(G){B(G);}}if(!n&&p.tkn){OK.tkn.set(p.tkn);}C({response:I,xhr:x});}else{B(x);}};x.onerror=function(){B(x);};x.send(t);});z.xhr=x;return z;}function i(m,n){return j({type:"GET",dataType:"json",url:m,data:n});}function e(n,m,o){if(!n||n.nodeType===3||n.nodeType===8){return;}var p=document.createEvent("CustomEvent");p.initCustomEvent(m,true,true,o);n.dispatchEvent(p);}function c(n){var m=document.createElement("div");m.innerText=n;return m.innerHTML;}function a(n){var m=n.getResponseHeader(OK.navigation.HEADER);if(m){return m.split(",");}return null;}function h(o,n){var m=o.split(OK.navigation.SPLITER);m.forEach(function(p,q){if(n[q]){OK.hookModel.setHookContent(n[q],p);}});}function g(m){return m.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'");}function b(m){return m.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ");}function f(n){var m=a(n.xhr);if(m){h(n.response,m);}}return{ajax:j,getJSON:i,trigger:e,encodeHtml:c,extractParams:k,getBlockIds:a,updateBlocks:h,updateBlockModelCallback:f,unescapeXml:g,formatNumber:b};});define("OK/PhoneForm",["OK/utils/vanilla","OK/utils/dom","OK/logger"],function(p,z,H){var f="data-",D=400,o=5,q="phoneValidationError",s,y,w,r,a,j,i,n,A,u,e,E,c,k;function h(M,J){if(typeof M==="string"){M=document.getElementById(M);}var O={};for(var L=0;L<M.attributes.length;L++){var I=M.attributes[L];if(I.name.indexOf(f)===0){var N=I.value;var K=I.name.substring(f.length);if(N==="false"){O[K]=false;}else{if(N==="true"){O[K]=true;}else{O[K]=I.value;}}}}if(J){M.parentNode.removeChild(M);}return O;}function t(){clearTimeout(E);if(c){c.abort();c=undefined;}}function b(I){y.classList.add("form_i__error");r.textContent=I;}function g(){y.classList.remove("form_i__error");r.textContent="";}function m(M,K,I){t();var J=j.logstats;if(v().length<o){if(K){K();}b(j["error-wrong-number"]);if(J){C("tooShort");}return;}else{if(!j.enabled){g();if(M){M();}return;}}c=p.ajax({type:"GET",url:j.url+"&phone="+encodeURIComponent(w.value),dataType:"json"}).then(function L(O){var R=O.response;var V=false;if(R.typing_check){var N=R.typing_check;A(N.modified_phone_number,N.modified_prefix);if(R.status==="OK"){var P=function(W){if(W){for(var X=0;X<W.length;X++){if(W[X]==="mobile"){return true;}}}if(J){C("notMobile");}return false;};if(j.checkMobile){V=P(N.prefix_state);}else{V=true;}}else{if(J){C("status"+R.status);}}}if(V){g();if(M){M();}}else{if(K){K();}var T=function(W){return W.charAt(0).toUpperCase()+W.slice(1)+".";};var S=R.printable;if(S&&S.length>0){var U=T(S[0]);if(S.length>1){for(var Q=1;Q<S.length;Q++){U+=" "+T(S[Q]);}}b(U);}else{b(j["error-wrong-number"]);}}},I).xhr;}function G(){return w;}function l(){return w.value.replace("+","");}function F(){return s.options[s.selectedIndex].getAttribute("data-id");}function C(L){var J=w.value;var K={phone:J,error:L};var I=JSON.stringify(K);H.success(q,I);}function d(){return s.value.replace("+","");}function B(){if(j.enabled){return"";}else{return d();}}function v(){if(j.enabled){return l();}else{return d()+l();}}function x(M){s=z.firstByClass(M,"js-country");y=z.firstByClass(M,"js-phone-form");w=z.firstByClass(M,"js-phone");r=z.firstByClass(M,"js-ph-vl-hint");var K=z.firstByClass(M,"js-hook-phone-correction");if(K){j=h(K,true);}else{j={enabled:false};}if(j.enabled){a={};for(var J=0;J<s.options.length;J++){var I=s.options[J].value.replace("+","");if(typeof a[I]==="undefined"){a[I]=J;}}A=function(O,P){w.value=O;i=O;if(n!==P){n=P;s.selectedIndex=a[n.replace("+","")];}};e=function(O){if(!k){O=O.replace("+","");for(var P=O.length;P>0;P--){var Q=O.substring(0,P);if(typeof a[Q]!=="undefined"){if(Q!==n.replace("+","")){s.selectedIndex=a[Q];n=s[s.selectedIndex].value;}break;}}}};n=s.value;}else{u=z.firstByClass(M,"js-phone-code");u.addEventListener("click",w.focus);}i=w.value;var L=function(){clearTimeout(E);var O;if(j.enabled){O=w.value.replace(/([^0-9+])/g,"").replace(/(^\+)|(\+)/g,"$1");}else{O=w.value.replace(/([^0-9])/g,"");}if(O!==w.value){w.value=O;}if(w.value===i){return;}else{i=w.value;if(j.enabled){e(w.value);}}if(j.enabled){var P=w.value.replace("+","");if(P.length>=o){t();E=setTimeout(m,D);}else{g();}}else{g();}};var N=function(){if(j.enabled){w.value=s.value+w.value.replace("+","").substring(n.length-1,w.value.length);n=s.value;k=true;L();}else{u.textContent=s.value;}};s.addEventListener("change",N);s.addEventListener("input",N);w.addEventListener("input",L);}return{init:x,getCountryId:F,getCountryCodeIfNotInNumber:B,getPhoneNumber:l,getPhoneInput:G,validatePhoneNumber:m};});define("OK/cookie",[],function(){return{setCookie:function(c,d,a,e){var f="",b;if(a){a=a*1000*60*60*24;b=new Date();b.setTime(b.getTime()+(a));f=";expires="+b.toUTCString();}document.cookie=c+"="+encodeURIComponent(d)+f+((e)?";path="+e:"");},readCookie:function(b){var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length);}if(f.indexOf(e)==0){return f.substring(e.length,f.length);}}return null;},clearCookie:function(a,b){this.setCookie(a,"",0,b);}};});define("OK/registration/enterPhone",["OK/registration/Utils","OK/PhoneForm","OK/utils/dom","OK/cookie"],function(c,b,d,a){return{activate:function(i){var e=i.parentNode,m=d.firstByClass(e,"js-general-error"),f=d.firstByClass(i,"js-proceed-registration"),k=d.firstByClass(i,"js-captcha"),l=i.getAttribute("data-type"),g=c.getActionByType(l),h=function(){var n={countryId:b.getCountryId(),countryCode:b.getCountryCodeIfNotInNumber(),phone:b.getPhoneNumber(),ccode:c.getInputValue(k)};n[g]="ValidatePhoneNumber";a.clearCookie(c.lastSmsTimeCookieName+l,"/");c.proceed(n,e,m,l);},j=function(){b.validatePhoneNumber(h,null,h);};b.init(d.firstByClass(i,"js-phone-form"));f.addEventListener("click",j);c.addSubmitHook(b.getPhoneInput(),j);}};});define("OK/registration/enterCode",["OK/registration/Utils","OK/utils/dom","OK/cookie"],function(c,d,b){return{activate:function(f){var n=f.parentNode,s=d.firstByClass(n,"js-general-error"),j=d.firstByClass(f,"js-back-to-enter-phone"),o=d.firstByClass(f,"js-proceed-registration"),v=d.firstByClass(f,"js-proceed-registration-container"),e=d.firstByClass(f,"js-resend-sms-code"),u=d.firstByClass(f,"js-resend-sms-code-disabled"),r=d.firstByClass(f,"js-resend-sms-code-container"),h=d.firstByClass(f,"js-sms-code"),k=u.value||u.innerHTML,i=f.getAttribute("data-type"),w=c.getActionByType(i),y=f.hasAttribute("data-code-expired"),x=c.lastSmsTimeCookieName+i,l=parseInt(f.getAttribute("data-resend-timeout"))||20,g=f.getAttribute("data-format-seconds")?a:function(z){return z;},p=function(){if(h.value){var z={smsCode:h.value};z[w]="ValidateCode";c.proceed(z,n,s,i);}},m=function(){var A=parseInt(b.readCookie(x),10),B=Date.now(),C,z;if(!A){A=B;b.setCookie(x,A,1,"/");}C=Math.round((B-A)/1000);u.value=u.innerHTML=k.replace("%d",g(l-C));if(C<=l){u.classList.remove("invisible");e.classList.add("invisible");z=setInterval(function(){B=Date.now();C=Math.round((B-A)/1000);if(C<=l){u.value=u.innerHTML=k.replace("%d",g(l-C));}else{clearInterval(z);u.classList.add("invisible");e.classList.remove("invisible");e.classList.remove("__disabled");}},300);}else{u.classList.add("invisible");e.classList.remove("invisible");e.classList.remove("__disabled");}};e.addEventListener("click",t);j&&j.addEventListener("click",function(){var z={registrationAction:"BackToEnterPhone"};c.proceed(z,n,s,i);});if(y){c.toggleClass(o,"__disabled",true);u.classList.add("invisible");e.classList.remove("invisible");}else{o.addEventListener("click",p);c.addSubmitHook(h,p);h.addEventListener("keyup",q);h.addEventListener("input",q);h.addEventListener("cut",function(){setTimeout(q,0);});h.addEventListener("propertychange",function(z){if(z.propertyName=="value"){q();}});q();m();}function t(){var z={};z[w]="ResendCode";c.proceed(z,n,s,i);b.clearCookie(x,"/");m();}function q(){var z=h.value==="";if(v){c.toggleClass(v,"invisible",z);}if(r){c.toggleClass(r,"invisible",!z);}c.toggleClass(o,"__disabled",z);}}};function a(h){var e=parseInt(h/3600)%24,f=parseInt(h/60)%60,g=h%60;return(e>0?(e+":"):"")+(f<10?"0"+f:f)+":"+(g<10?"0"+g:g);}});define("OK/registration/chooseUser",["OK/registration/Utils"],function(a){return{activate:function(e){var b=e.parentNode,m=b.getElementsByClassName("js-general-error")[0],l=e.getElementsByClassName("js-its-not-me-button")[0],h=b.getElementsByClassName("chooseUserButton"),d=a.getAttributesFromHook(e.getElementsByClassName("js-action-hook")[0],true)["action"],j=e.getAttribute("data-type"),f,c,k=function(o){var n=o.target.getAttribute("data-value"),i={userId:n,registrationAction:"RecoverUser"};a.proceed(i,b,m,j);},g=function(){var i={registrationAction:d};a.proceed(i,b,m,j);};if(h){for(f=0,c=h.length;f<c;f++){h[f].addEventListener("click",k);}}l.addEventListener("click",g);}};});define("OK/registration/authorize",["OK/registration/Utils","OK/logger","OK/utils/dom"],function(b,a,c){return{activate:function(n){var J=n.parentNode,r=c.firstByClass(J,"js-general-error"),O=c.firstByClass(n,"js-proceed"),A=c.firstByClass(n,"js-enter-password"),C=c.firstByClass(n,"js-enter-login"),q=c.firstByClass(n,"js-support-link"),Q=n.getAttribute("data-type"),d=b.getActionByType(Q),H=n.getAttribute("data-enabled-log-timer"),P=n.getAttribute("data-validate-password-in-js")||true,D=0,E=300000;if(C){var G=b.getAttributesFromHook(c.firstByClass(n,"js-login-restrictions-hook"),true),N=new RegExp(G["allowed-symbols-pattern"]),K=G["min-length"],o=c.firstByClass(n,"js-login-hint"),v=c.firstByClass(n,"js-login-form"),g=c.firstByClass(n,"js-login-error"),L=b.getAttributesFromHook(c.firstByClass(n,"js-hook-login-msg"),true);var p=function(R){var S=C.value;if(!N.test(S)){b.showFieldError(v,o,g,L["invalid-characters"]);}else{if(!R){if(S==""){b.showFieldError(v,o,g,L.empty);}else{if(S.length<K){b.showFieldError(v,o,g,L["short"]);}else{b.hideFieldError(v,o);return true;}}}else{b.hideFieldError(v,o);return true;}}return false;};C.addEventListener("keyup",function(){p(true);});}var w;var k=c.firstByClass(n,"js-password-restrictions-hook");if(k){var m=b.getAttributesFromHook(k,true);var z=m["min-length"];var F=new RegExp(m["allowed-symbols-pattern"]);var I=new RegExp(m["must-contain-pattern"]);var y=m["split-must-contain-pattern"];var l=/[a-zA-Z]+/;var s=/[0-9]+/;var u=c.firstByClass(n,"js-password-error");var j=c.firstByClass(n,"js-password-form");var x=c.firstByClass(n,"js-password-indicator-container");var h=c.firstByClass(n,"js-password-rate");var B=h.getElementsByClassName("progress-rate_bar");var e=c.firstByClass(n,"js-password-indicator-hint");var M=b.getAttributesFromHook(c.firstByClass(n,"js-hook-pwd-msg"),true);var i=function(U,T,S){h.className="progress-rate mt-2x "+U;if(T>0){for(var R=0;R<T;R++){B[R].classList.add("__full");}}if(T<3){for(R=T;R<B.length;R++){B[R].classList.remove("__full");}}b.toggleClass(j,"form_i__error",S);b.toggleClass(e,"reg_error_txt",S);};w=function(R,S,T){if(u&&T){return;}if(u){b.toggleClass(j,"form_i__error",true);b.toggleClass(x,"invisible",false);u.parentNode.removeChild(u);u=null;}if(R==""){e.textContent=M.empty;i("",0,S);}else{if(!F.test(R)){i("__weak",3,true);e.textContent=M.invalid;}else{if(R.length<z||!I.test(R)){if(R.length<z&&!I.test(R)){i("__weak",1,true);}else{i("__normal",2,true);}if(R.length<z){e.textContent=M["short"];}else{e.textContent=M["must-contain"];if(y=="true"){if(l.test(R)){e.textContent=M["only-letters"];}else{if(s.test(R)){e.textContent=M["only-numbers"];}}}}}else{e.textContent=M.ok;i("__strong",3,false);return true;}}}return false;};}else{w=function(R,S,T){if(u&&T){return;}return true;};}A.addEventListener("keyup",function(){w(A.value,true);});var t=function(){var S=true;if(C){S=p();}if((!w(A.value,true)||!S)&&("true"==P)){return;}var R={password:A.value,};R[d]="Authorize";if(C){R.login=C.value;}if(q){R.splnk="on";}b.proceed(R,J,r,Q);};O.addEventListener("click",t);b.addSubmitHook(A,t);w(A.value,false,true);var f=function(){D+=1;a.success("recovery","ppot",b.getValueForLog(D));setTimeout(f,E);};if("recovery"==Q&&"true"==H){setTimeout(f,5);}}};});define("OK/registration/socialAuthHandler",[],function(){var a,c;function b(e,d){if(a&&c&&c==d){a(e);}window.socialAuthCallback=a=c=undefined;}return{openWindow:function(d,e){window.socialAuthCallback=b;a=e;c=window.open(d,"","width=600, height=600");}};});define("OK/registration/socialSignIn",["OK/utils/utils","OK/utils/dom","OK/registration/socialAuthHandler"],function(a,f,e){var d={url:"/dk",data:{cmd:"SocialSignIn"}};function c(g,i){function h(k,j){d.data["s.sign.error"]=j;d.data["s.sign.code"]=k;d.data["s.sign.socialProvider"]=g;a.ajax(d).done(i.done).fail(i.fail);}return function(j){if(j.error=="access_denied"){return;}h(j.code||"",j.error||"");};}function b(g,h){return{done:function(i){g.innerHTML=i;},fail:function(i,k,j){if(j!="Redirect"){g.innerHTML=h;}}};}return{activate:function(k){var i=k.getAttribute("data-url");var h=k.getAttribute("data-provider");var l=k.getAttribute("data-error-field");var j=k.getAttribute("data-network-error");var g=f.firstByClass(document,l);k.addEventListener("click",function(m){g.innerHTML="";e.openWindow(i,c(h,b(g,j)));m.preventDefault();});}};});define("OK/registration/cancelSocialReg",["OK/registration/Utils","OK/utils/dom","OK/cookie"],function(b,c,a){return{activate:function(g){var e=g,f,h=g.getAttribute("data-type"),i=b.getActionByType(h),d=function(k){var j={};j[i]="CancelSocialRegistration";a.clearCookie(b.lastSmsTimeCookieName+h,"/");b.proceed(j,e,f,h);k.preventDefault();};while(e.parentNode&&!e.parentNode.classList.contains("js-page-cnt")){e=e.parentNode;}e=e.parentNode;f=c.firstByClass(e,"js-general-error");g.addEventListener("click",d);}};});define("b/registration",["OK/registration/Registration","OK/registration/Utils","OK/registration/enterPhone","OK/registration/enterCode","OK/registration/chooseUser","OK/registration/authorize","OK/registration/socialSignIn","OK/registration/socialAuthHandler","OK/registration/cancelSocialReg","OK/registration/StatesManager"],{});