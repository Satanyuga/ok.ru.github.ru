define(["OK/logger"],function(u){var o=null;var i=null;var t="nogwt";var f=false;var n=5000;var e=100;var j=5;var a=0;var l=0;var r=0;var m=null;function h(){return document.documentElement.classList.contains("oh");}(function k(){if(document.hidden!==undefined){o="hidden";i="visibilitychange";}else{if(document.mozHidden!==undefined){o="mozHidden";i="mozvisibilitychange";}else{if(document.msHidden!==undefined){o="msHidden";i="msvisibilitychange";}else{if(document.webkitHidden!==undefined){o="webkitHidden";i="webkitvisibilitychange";}}}}}());function s(v){if(v-l>e){r+=1;}l=v;if((v-a>n)){p(true);}else{m=window.requestAnimationFrame(s);}}function g(){r=0;l=window.performance.now();a=l;f=h();m=window.requestAnimationFrame(s);}function p(w){window.cancelAnimationFrame(m);m=null;if(w){if((r>j)&&(r<(n/e))){var v=t;if(f||h()){v="layer";}if(u.duration){u.duration("framerate",r,v);}}g();}}function d(){t=OK.getCurrentDesktopModelId();p(false);g();}function q(){if(document[o]){p(false);}else{g();}}function c(v){n=Number(v.getAttribute("data-test-time"))||n;e=Number(v.getAttribute("data-threshold"))||e;j=Number(v.getAttribute("data-lags-limit"))||j;t=(OK.getCurrentDesktopModelId&&OK.getCurrentDesktopModelId())||t;if(i){window.addEventListener("navigationStateChanged",d);document.addEventListener(i,q,false);}g();}function b(){p(false);if(i){window.addEventListener("navigationStateChanged",d);document.removeEventListener(i,q);}}return{activate:c,deactivate:b};});